<!DOCTYPE html>
<html>
<head>
    <title>Messel V2</title>
    <style>
        #chat-container {
            max-width: 500px;
            margin: 0 auto;
        }
        #chat-area {
            height: 300px;
            border: 1px solid #ccc;
            overflow-y: scroll;
        }
        input, button {
            display: block;
            margin: 5px 0;
        }
        #send-button {
            cursor: pointer;
            background: none;
            border: none;
            padding: 0;
            margin: 0;
            width: 40px;
            height: 40px;
            float: left;
            margin-right: 10px;
            margin-left: 10px; 
            margin-top: -7px;
        }
        #message {
            width: calc(100% - 110px); 
            height: 30px; 
            float: left; 
        }
    </style>
</head>
<body>
    <div id="chat-container">
        <div id="chat-area"></div>
        <input type="text" id="name" placeholder="名前を入力">
        <input type="text" id="message" placeholder="メッセージを入力">
        <button id="send-button">
            <svg xmlns="http://www.w3.org/2000/svg" width="90" height="60" viewBox="0 0 1050.08 405.06">
                  <defs>
                    <style>
                      .cls-1 {
                        fill: #fff;
                      }
                
                      .cls-1, .cls-2 {
                        stroke-width: 0px;
                      }
                
                      .cls-2 {
                        fill: #55d6ff;
                      }
                    </style>
                  </defs>
                  <rect class="cls-2" x="0" y="0" width="1050.08" height="405.06" rx="202.53" ry="202.53"/>
                  <g>
                    <g>
                      <polygon class="cls-1" points="191.38 283.34 228.16 254.92 191.38 229.91 191.38 283.34"/>
                      <polygon class="cls-1" points="141.4 181.65 191.89 218.26 332.71 128.23 204.08 227.1 279.28 281.62 351.67 112.72 141.4 181.65"/>
                    </g>
                    <g>
                      <path class="cls-1" d="m655.14,307.6h-114.24c-6.23,0-11.71-.37-16.46-1.11-4.75-.74-8.93-1.76-12.53-3.07-3.6-1.31-6.8-2.91-9.58-4.79-2.79-1.88-5.32-4.05-7.62-6.51-3.11,4.26-7.58,8.31-13.39,12.16-5.82,3.85-12.33,6.92-19.53,9.21l-20.15-46.43c4.09-.82,7.9-1.88,11.42-3.19,3.52-1.31,6.18-2.37,7.98-3.19,1.8-.82,2.78-1.31,2.95-1.47v-42.01h-19.41v-43.98h65.1v76.65c2.29,3.77,4.95,6.76,7.98,8.97,3.03,2.21,7.65,3.56,13.88,4.05l-20.88-38.08c10.81-1.8,19.57-4.34,26.29-7.62,6.71-3.27,11.79-7.29,15.23-12.04h-37.59v-37.1h45.7c.16-1.8.25-3.6.25-5.41s.08-3.68.25-5.65h-42.5v-36.85h14.25c-1.15-2.62-2.46-5.24-3.93-7.86-1.47-2.62-2.7-4.63-3.69-6.02-.98-1.39-1.56-2.17-1.72-2.33l42.26-11.3,1.72,2.21c.98,1.64,2.21,3.73,3.68,6.26,1.47,2.54,3.07,5.49,4.79,8.84,1.72,3.36,3.23,6.76,4.54,10.2h8.84c2.29-3.44,4.21-6.76,5.77-9.95,1.55-3.19,2.86-6.1,3.93-8.72,1.06-2.62,1.84-4.75,2.33-6.39l.74-2.21,46.68,6.88c-.17.33-.66,1.39-1.47,3.19-.82,1.8-2.05,4.34-3.69,7.62-1.64,3.28-3.52,6.47-5.65,9.58h13.51v36.85h-42.75c0,1.8-.04,3.65-.12,5.53-.08,1.88-.12,3.73-.12,5.53h47.66v37.1h-41.03c5.24,4.91,11.71,9.01,19.41,12.28,7.7,3.28,16.13,5.82,25.3,7.62l-17.69,37.59,21.87-.25-8.6,45.2Zm-177.87-142.49l-2.7-4.67c-1.96-2.95-4.54-6.76-7.74-11.42-3.19-4.67-6.88-9.74-11.06-15.23-4.18-5.49-8.48-10.77-12.9-15.85l38.82-24.81c4.75,4.59,9.21,9.54,13.39,14.86,4.18,5.32,7.86,10.28,11.06,14.86,3.19,4.59,5.77,8.35,7.74,11.3l2.7,4.67-39.31,26.29Zm124.68,86.11c-7.29-5.32-13.47-11.01-18.55-17.07-4.42,6.23-10.07,12.04-16.95,17.44-6.88,5.4-14.49,9.42-22.85,12.04l80.33-.74c-7.37-2.46-14.7-6.35-21.99-11.67Z"/>
                      <path class="cls-1" d="m759.18,124.94c-2.38,7.29-4.96,14.37-7.74,21.25v167.55h-46.68v-102.45c-.82,1.15-2.01,2.42-3.56,3.81-1.56,1.39-2.87,2.46-3.93,3.19-1.07.74-1.68,1.19-1.84,1.35l-8.11-63.38,3.44-4.67c2.13-2.95,4.79-7.21,7.98-12.78,3.19-5.57,6.47-12.24,9.83-20.02,3.35-7.78,6.18-16.34,8.48-25.67l48.4,10.56c-1.8,6.88-3.89,13.96-6.26,21.25Zm-1.84,39.92v-34.15h151.33v34.15h-151.33Zm101.22,148.88v-4.91h-50.36v4.91h-46.68v-78.37h143.72v78.37h-46.68Zm-93.36-115.71v-28.99h135.86v28.99h-135.86Zm0,33.17v-28.99h135.86v28.99h-135.86Zm.74-104.66v-29.48h135.12v29.48h-135.12Zm92.62,142.24h-50.36v6.63h50.36v-6.63Z"/>
                    </g>
                  </g>
            </svg>
        </button>
    </div>

    <script>
        const nameInput = document.getElementById("name");
        const messageInput = document.getElementById("message");
        const sendButton = document.getElementById("send-button");
        const chatArea = document.getElementById("chat-area");

        const getCurrentTime = () => {
            const now = new Date();
            const hours = now.getHours().toString().padStart(2, "0");
            const minutes = now.getMinutes().toString().padStart(2, "0");
            const seconds = now.getSeconds().toString().padStart(2, "0");
            return `[${hours}:${minutes}:${seconds}]`;
        };
        
        if (localStorage.getItem("chatName")) {
            nameInput.value = localStorage.getItem("chatName");
        }

        const websocket = new WebSocket("ws://163.43.145.48:3000"); 

        websocket.addEventListener("open", (event) => {
            console.log("WebSocket接続が確立されました");
        });

        websocket.addEventListener("message", (event) => {
            const message = event.data;
            appendMessage(message);
        });

        sendButton.addEventListener("click", () => {
            sendMessage();
        });

        messageInput.addEventListener("keydown", (event) => {
            if (event.key === "Enter") {
                sendMessage();
            }
        });

        function sendMessage() {
            const name = nameInput.value;
            localStorage.setItem("chatName", name);
            const message = messageInput.value;
            if (message) {
                const chatMessage = `|${getCurrentTime()} ${name}:`;
                const chatMessage2 = `|    ${message}`;
                websocket.send(chatMessage);
                appendMessage(chatMessage); 
                websocket.send(chatMessage2);
                appendMessage(chatMessage2); 
                messageInput.value = "";
            }
        }

        function appendMessage(message) {
            const messageElement = document.createElement("div");
            if (typeof message === "string") {
                messageElement.textContent = message;
            } else {
                message.text().then((text) => {
                    messageElement.textContent = text;
                });
            }
            chatArea.appendChild(messageElement);
            chatArea.scrollTop = chatArea.scrollHeight; 
        }
    </script>
</body>
</html>
